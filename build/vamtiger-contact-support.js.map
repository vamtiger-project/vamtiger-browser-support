{"version":3,"file":"vamtiger-contact-support.js","sources":["../source/types.ts","../source/get-root-path.ts","../source/vamtiger-contact-support.ts"],"sourcesContent":["import * as AWS from 'aws-sdk';\n\nexport enum StringConstant {\n    nothing = '',\n    vamtiger = 'vamtiger',\n    slash = '/',\n    jsExtension = '.js',\n    bashAnd = '&&',\n    arn = 'arn',\n    sns = 'sns',\n    aws = 'aws',\n    colon = ':',\n    hyphen = '-',\n    'vamtiger-contact' = 'vamtiger-contact',\n    '5e5164d3' = '5e5164d3',\n    cc71 = 'cc71',\n    '4e5b' = '4e5b',\n    '9c34' = '9c34',\n    '042fe735f31c' = '042fe735f31c'\n}\n\nexport enum Region {\n    usWest2= 'us-west-2'\n}\n\nexport enum ElmentName {\n    meta = 'meta',\n    script = 'script'\n}\n\nexport enum ElementId {\n    vamtigerBrowserSupport = 'vamtiger-browser-support'\n}\n\nexport enum ElementAttribute {\n    id = 'id'\n}\n\nexport enum MetaElementAttribute {\n    baseUrl = 'baseUrl',\n    name = 'name',\n    url = 'url',\n    primary = 'primary',\n    loaded = 'loaded',\n    supported = 'supported',\n    unsupported = 'unsupported',\n    error = 'error',\n    polyfill = 'polyfill',\n    loadCritical = 'loadCritical',\n    load = 'load',\n    wait = 'wait'\n}\n\nexport enum MetaElementBrowserSupportAttribute {\n    es2015Support = 'data-es2015-support',\n    elementQuerySupport = 'data-element-query-support',\n    webComponentSupport = 'data-web-component-support',\n    fetchSupport = 'data-fetch-support',\n    awsSupport = 'data-aws-support',\n    contactSupport = 'data-contact-support'\n}\n\nexport enum Selector {\n    vamtigerBrowserSupportScript = 'script[src*=\"vamtiger-browser-support\"]'\n}\n\nexport enum ErrorMessage {\n    notBrowser = 'This is not a web browser'\n}\n\nexport enum NpmScript {\n    bundleSource = 'bundle-source'\n}\n\nexport enum SupportType {\n    primary = 'primary',\n    secondary = 'secondary'\n}\n\nexport enum LoadOnComplete {\n    loadCritical = 'loadCritical',\n    load = 'load'\n}\n\nexport type LoadOnCompleteType  = keyof typeof LoadOnComplete;\n\nexport type Support = keyof typeof MetaElementBrowserSupportAttribute;\n\nexport type SupportTypeKey = keyof typeof SupportType;\n\nexport type StringObject = {[key: string]: string};\n\nexport type AnyObject = {[key: string]: any};\n\nexport type VamtigerSupportFile = 'vamtiger-es2015-support';\n\nexport interface ISetBrowserSupportMetaElement {\n    support: Support;\n    primary?: boolean;\n}\n\nexport interface IUpdateBrowserSupport {\n    supportFile: string;\n    supported?: boolean;\n    polyfill?: string;\n    polyfills?: string[];\n    chain?: boolean;\n    wait?: boolean;\n    error?: string;\n}\n\nexport interface IUpdateBrowserSupportLoadScripts {\n    polyfills: string[];\n}\n\nexport interface IGetSupportUrls {\n    supportType: SupportType;\n}\n\nexport interface ILoadNextSupport {\n    supportType: SupportType;\n}\n\nexport interface IVamtigerContactParams {\n    template: string;\n    subject: string;\n    origin: string;\n}\n\nexport type VamtigerSupport =  {\n    [K in VamtigerSupportFile]?: IUpdateBrowserSupport;\n}\n\ndeclare global {\n    interface Window extends VamtigerSupport {\n        [ElementId.vamtigerBrowserSupport]: HTMLMetaElement,\n        VamtigerBrowserSupport: (params: IUpdateBrowserSupport) => void;\n        VamtigerContact: (params: IVamtigerContactParams) => Promise<AWS.SNS.PublishResponse>;\n        _VamtigerContact_: (params: any) => void;\n        AWS: typeof AWS;\n    }\n}\n\nexport const supportTypes = Object.keys(SupportType) as SupportType[];\n\nexport const regex = {\n    leadingData: /^data/,\n    trailingSupport: /(.*?Support)(Primary)?$/,\n    supportScript: /vamtiger(-\\w+)+-(support|polyfill)/\n}\n\nexport const stringConstant = Object.assign(StringConstant, {\n    365080655670: 365080655670\n});","import { Selector, StringConstant } from './types';\n\nconst { slash, nothing } = StringConstant;\n\nlet rootPath: string;\n\nfunction generateRootPath() {\n    const { head, body} = document;\n    const { vamtigerBrowserSupportScript: selector } = Selector;\n    const vamtigerBrowserSupportScript = head.querySelector<HTMLScriptElement>(selector)\n        || body.querySelector<HTMLScriptElement>(selector);\n    const { pathname, origin } = new URL(vamtigerBrowserSupportScript.src);\n    const paths = pathname\n        .split(slash)\n        .filter(path => path.trim())\n        .filter((path, index, paths) => index < paths.length - 1);\n    const currentRootPath = [origin]\n        .concat(paths)\n        .join(slash);\n\n    rootPath = currentRootPath;\n\n    return currentRootPath;\n}\n\nfunction getRootPath() {\n    rootPath = rootPath || generateRootPath();\n\n    return rootPath;\n};\n\nexport default getRootPath;","import getRootPath from './get-root-path';\nimport { IUpdateBrowserSupport } from './types';\n\nconst { VamtigerContact, VamtigerBrowserSupport } = window;\nconst rootPath = getRootPath();\nexport const supportFile = 'vamtiger-contact-support';\nexport const polyfills = [\n    `${rootPath}/vamtiger-contact-polyfill-support.js`,\n    `${rootPath}/vamtiger-contact-polyfill.js`\n];\nconst params = {\n    supportFile,\n    supported: VamtigerContact ? true : false,\n    chain: true\n} as IUpdateBrowserSupport;\n\nif (!params.supported) {\n    params.polyfills = polyfills;\n}\n\nVamtigerBrowserSupport(params);"],"names":["StringConstant","Region","ElmentName","ElementId","ElementAttribute","MetaElementAttribute","MetaElementBrowserSupportAttribute","Selector","ErrorMessage","NpmScript","SupportType","LoadOnComplete","Object","assign","365080655670","rootPath","slash","head","body","selector","vamtigerBrowserSupportScript","_a","pathname","origin","paths","currentRootPath","VamtigerContact","VamtigerBrowserSupport","querySelector","split","filter","path","trim","index","length","concat","join","polyfills","params","supportFile","supported","chain"],"mappings":"mCAEA,IAAYA,EAmBAC,EAIAC,EAKAC,EAIAC,EAIAC,EAeAC,EASAC,EAIAC,EAIAC,EAIAC,EAKAC,GA7EZ,SAAYX,GACRA,aACAA,sBACAA,YACAA,oBACAA,eACAA,YACAA,YACAA,YACAA,YACAA,aACAA,yCACAA,yBACAA,cACAA,iBACAA,iBACAA,iCAhBJ,CAAYA,IAAAA,OAmBZ,SAAYC,GACRA,sBADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,cACAA,kBAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,oDADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,UADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,oBACAA,cACAA,YACAA,oBACAA,kBACAA,wBACAA,4BACAA,gBACAA,sBACAA,8BACAA,cACAA,cAZJ,CAAYA,IAAAA,OAeZ,SAAYC,GACRA,sCACAA,mDACAA,mDACAA,oCACAA,gCACAA,wCANJ,CAAYA,IAAAA,OASZ,SAAYC,GACRA,yEADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,yCADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,+BADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,oBACAA,wBAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,8BACAA,cAFJ,CAAYA,IAAAA,OAwEkBC,OAAOC,OAAOb,GACxCc,aAAc,eATlB,IC3IIC,EAFIC,oBCCA,IDIIC,EAAMC,EACNC,EACFC,EAEAC,EAAEC,EAAUC,EACZC,EAIAC,ECbFC,yBAAiBC,gCACnBZ,EDsBFA,EAAWA,IAnBHE,gBAAMC,gBACNC,iCACFC,EAA+BH,EAAKW,cAAiCT,IACpED,EAAKU,cAAiCT,GACvCE,iBAAEC,aAAUC,WACZC,EAAQF,EACTO,MAAMb,GACNc,OAAO,SAAAC,GAAQ,OAAAA,EAAKC,SACpBF,OAAO,SAACC,EAAME,EAAOT,GAAU,OAAAS,EAAQT,EAAMU,OAAS,IACrDT,GAAmBF,GACpBY,OAAOX,GACPY,KAAKpB,GAEVD,EAAWU,EAEJA,GChBEY,GACNtB,0CACAA,mCAEDuB,GACFC,YANuB,2BAOvBC,YAAWd,EACXe,OAAO,UAGNH,EAAOE,YACRF,EAAOD,UAAYA,GAGvBV,EAAuBW,iBAfI"}