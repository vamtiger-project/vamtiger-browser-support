{"version":3,"file":"vamtiger-web-component-support.js","sources":["../source/vamtiger-web-component-support.ts"],"sourcesContent":["import { IUpdateBrowserSupport } from './types';\nimport loadScript from '../node_modules/vamtiger-browser-method/source/load-script';\nimport pause from '../node_modules/vamtiger-browser-method/source/pause';\n\nconst { VamtigerBrowserSupport } = window;\nconst supportFile = 'vamtiger-web-component-support';\nconst polyfill = 'https://unpkg.com/@webcomponents/webcomponentsjs';\nconst params = {\n    supportFile\n} as IUpdateBrowserSupport;\nconst webComponent = `\nconst shadowDomTemplate = document.createElement('template');\n\nshadowDomTemplate.innerHTML = \\`\n<style>\n    .container {\n        border: 1px solid red;\n    }\n</style>\n\n<div class=\"container\">\n    <slot name=\"test-slot-1\"></slot>\n    <span>\n            VAMTIGER Browser Support\n    </span>\n    <slot name=\"test-slot-2\"></slot>\n</div>\n\\`\n\nclass VamtigerWebComponentSupport extends HTMLElement {\n    static get observedAttributes() {\n        const observedAttributes = [\n            'data-${supportFile}'\n        ];\n\n        return observedAttributes;\n    }\n\n    constructor() {\n        super();\n        const template = shadowDomTemplate.content.cloneNode(true);\n        const shadowRoot = this.attachShadow({mode: 'open'});\n\n        shadowRoot.appendChild(template);\n    }\n\n    connectedCallback() {\n        this.dataset['vamtigerWebComponentSupportConnectedCallback'] = '';\n    }\n\n    disconnectedCallback() {\n        this.dataset['vamtigerWebComponentSupportDisconnectedCallback'] = '';\n    }\n\n    attributeChangedCallback(attrName, oldValue, newValue) {\n        this.dataset['vamtigerWebComponentSupportOldValue'] = oldValue;\n        this.dataset['vamtigerWebComponentSupportNewValue'] = newValue;\n\n        this.dataset['vamtigerWebComponentSupportAttributeChangedCallback'] = '';\n    }\n}\n\ncustomElements.define('${supportFile}', VamtigerWebComponentSupport);\n`;\n\nfunction test() {\n    const { body } = document;\n    const customElement = document.createElement(supportFile);\n\n    let result = false;\n\n    customElement.innerHTML = `\n        <span slot=\"test-slot-1\">\n            Test Slot 1\n        </span>\n        <span>\n            No slot defined\n        </span>\n\n        <span slot=\"test-slot-2\">\n            Test Slot 2\n        </span>\n    `;\n\n    customElement.dataset['vamtigerWebComponentSupport'] = 'old-value';\n\n    body.appendChild(customElement);\n\n    customElement.dataset['vamtigerWebComponentSupport'] = 'new-value';\n\n    body.removeChild(customElement);\n\n    result = customElement.dataset.hasOwnProperty('vamtigerWebComponentSupportConnectedCallback')\n        && customElement.dataset.hasOwnProperty('vamtigerWebComponentSupportDisconnectedCallback')\n        && customElement.dataset['vamtigerWebComponentSupportOldValue'] === 'old-value'\n        && customElement.dataset['vamtigerWebComponentSupportNewValue'] === customElement.dataset['vamtigerWebComponentSupport']\n        && customElement.shadowRoot.children.length === 2\n        && window.hasOwnProperty('HTMLTemplateElement')\n        && window.hasOwnProperty('HTMLSlotElement')\n        && !!HTMLElement.prototype.attachShadow;\n\n    return result;\n}\n\ntry {\n    eval(webComponent);\n\n    params.supported = test();\n} catch(error) {\n    params.error = error;\n}\n\nif (!params.supported) {\n    params.polyfill = polyfill;\n\n}\n\nVamtigerBrowserSupport(params);"],"names":["VamtigerBrowserSupport","supportFile","polyfill","params","webComponent","test","body","customElement","document","createElement","innerHTML","dataset","appendChild","removeChild","hasOwnProperty","shadowRoot","children","length","window","HTMLElement","prototype","attachShadow","eval","supported","error"],"mappings":"yBAIQ,IAAAA,qDACFC,YAAc,iCACdC,SAAW,mDACXC,QACFF,yBAEEG,aAAe,igBAsBDH,41BA8BKA,iDAGzB,SAASI,OACG,IAAAC,gBACFC,EAAgBC,SAASC,cAAcR,aAkC7C,OA9BAM,EAAcG,UAAY,mOAa1BH,EAAcI,QAAqC,4BAAI,YAEvDL,EAAKM,YAAYL,GAEjBA,EAAcI,QAAqC,4BAAI,YAEvDL,EAAKO,YAAYN,GAERA,EAAcI,QAAQG,eAAe,iDACvCP,EAAcI,QAAQG,eAAe,oDAC4B,cAAjEP,EAAcI,QAA6C,qCAC3DJ,EAAcI,QAA6C,sCAAMJ,EAAcI,QAAqC,6BACvE,IAA7CJ,EAAcQ,WAAWC,SAASC,QAClCC,OAAOJ,eAAe,wBACtBI,OAAOJ,eAAe,sBACpBK,YAAYC,UAAUC,aAKnC,IACIC,KAAKlB,cAELD,OAAOoB,UAAYlB,OACrB,MAAMmB,GACJrB,OAAOqB,MAAQA,EAGdrB,OAAOoB,YACRpB,OAAOD,SAAWA,UAItBF,uBAAuBG"}